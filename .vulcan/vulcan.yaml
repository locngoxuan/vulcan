name: 'Using Vulcan to build Vulcan'
jobs:
  vexec:
    name: 'Build vulcan executor binary'
    run-on: 'golang:1.16.5-alpine3.13'
    steps:
      - name: 'add missing and remove unused mod'
        run: go mod tidy
      - name: 'download necessary modules and make vendored copy of dependencies'
        run: |
          go get -v ./cmd/vexec
          rm -rf vendor
          go mod vendor
      - name: 'build binary file'
        run: go build -ldflags='-s -w' -o ./bin/vexec ./cmd/vexec